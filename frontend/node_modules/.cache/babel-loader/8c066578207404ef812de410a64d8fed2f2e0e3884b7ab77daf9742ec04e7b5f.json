{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback } from 'react';\nconst getDistanceFromLatLonInKm = (lat1, lon1, lat2, lon2) => {\n  const R = 6371; // Radius of the earth in km\n  const deg2rad = deg => deg * (Math.PI / 180);\n  const dLat = deg2rad(lat2 - lat1);\n  const dLon = deg2rad(lon2 - lon1);\n  const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c; // Distance in km\n};\nexport const useProductCategory = (categoryName, searchQuery) => {\n  _s();\n  const [products, setProducts] = useState([]);\n  const [filteredProducts, setFilteredProducts] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const addDistanceToProducts = useCallback((prods, userLat, userLon) => {\n    return prods.map(product => {\n      if (product.lat && product.lon) {\n        const distance = getDistanceFromLatLonInKm(userLat, userLon, product.lat, product.lon);\n        return {\n          ...product,\n          distance: `${distance.toFixed(1)} km away`\n        };\n      }\n      return {\n        ...product,\n        distance: 'Distance N/A'\n      };\n    });\n  }, []);\n  useEffect(() => {\n    const fetchProducts = async () => {\n      try {\n        setLoading(true);\n        const response = await fetch(`http://localhost:5000/api/products/category/${categoryName}`);\n        if (response.ok) {\n          let data = await response.json();\n          setProducts(data);\n          setFilteredProducts(data); // Initially set filtered to all\n        } else {\n          setError(`Failed to load ${categoryName} products`);\n        }\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchProducts();\n  }, [categoryName]);\n  useEffect(() => {\n    if (products.length > 0 && navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(position => {\n        const userLat = position.coords.latitude;\n        const userLon = position.coords.longitude;\n        const productsWithDistance = addDistanceToProducts(products, userLat, userLon);\n        setProducts(productsWithDistance);\n        setFilteredProducts(productsWithDistance);\n      }, () => {\n        // On error, just use products without distance\n        setFilteredProducts(products.map(p => ({\n          ...p,\n          distance: 'Within 5km'\n        })));\n      });\n    }\n  }, [products, addDistanceToProducts]);\n  useEffect(() => {\n    setFilteredProducts(products.filter(p => p.name.toLowerCase().includes(searchQuery.toLowerCase())));\n  }, [searchQuery, products]);\n  return {\n    filteredProducts,\n    loading,\n    error\n  };\n};\n_s(useProductCategory, \"dB2W+eU4gpLxMSz+cifLBLvtqS8=\");","map":{"version":3,"names":["useState","useEffect","useCallback","getDistanceFromLatLonInKm","lat1","lon1","lat2","lon2","R","deg2rad","deg","Math","PI","dLat","dLon","a","sin","cos","c","atan2","sqrt","useProductCategory","categoryName","searchQuery","_s","products","setProducts","filteredProducts","setFilteredProducts","loading","setLoading","error","setError","addDistanceToProducts","prods","userLat","userLon","map","product","lat","lon","distance","toFixed","fetchProducts","response","fetch","ok","data","json","err","message","length","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","productsWithDistance","p","filter","name","toLowerCase","includes"],"sources":["C:/Users/User/Downloads/REDDYS/ECOMM-R/frontend/src/Customer/Categories/Products/Jewllery/useProductCategory.js"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\n\r\nconst getDistanceFromLatLonInKm = (lat1, lon1, lat2, lon2) => {\r\n    const R = 6371; // Radius of the earth in km\r\n    const deg2rad = (deg) => deg * (Math.PI / 180);\r\n    const dLat = deg2rad(lat2 - lat1);\r\n    const dLon = deg2rad(lon2 - lon1);\r\n    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\r\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n    return R * c; // Distance in km\r\n};\r\n\r\nexport const useProductCategory = (categoryName, searchQuery) => {\r\n    const [products, setProducts] = useState([]);\r\n    const [filteredProducts, setFilteredProducts] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n\r\n    const addDistanceToProducts = useCallback((prods, userLat, userLon) => {\r\n        return prods.map(product => {\r\n            if (product.lat && product.lon) {\r\n                const distance = getDistanceFromLatLonInKm(userLat, userLon, product.lat, product.lon);\r\n                return { ...product, distance: `${distance.toFixed(1)} km away` };\r\n            }\r\n            return { ...product, distance: 'Distance N/A' };\r\n        });\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const fetchProducts = async () => {\r\n            try {\r\n                setLoading(true);\r\n                const response = await fetch(`http://localhost:5000/api/products/category/${categoryName}`);\r\n                if (response.ok) {\r\n                    let data = await response.json();\r\n                    setProducts(data);\r\n                    setFilteredProducts(data); // Initially set filtered to all\r\n                } else {\r\n                    setError(`Failed to load ${categoryName} products`);\r\n                }\r\n            } catch (err) {\r\n                setError(err.message);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchProducts();\r\n    }, [categoryName]);\r\n\r\n    useEffect(() => {\r\n        if (products.length > 0 && navigator.geolocation) {\r\n            navigator.geolocation.getCurrentPosition(\r\n                (position) => {\r\n                    const userLat = position.coords.latitude;\r\n                    const userLon = position.coords.longitude;\r\n                    const productsWithDistance = addDistanceToProducts(products, userLat, userLon);\r\n                    setProducts(productsWithDistance);\r\n                    setFilteredProducts(productsWithDistance);\r\n                },\r\n                () => { // On error, just use products without distance\r\n                    setFilteredProducts(products.map(p => ({...p, distance: 'Within 5km' })));\r\n                }\r\n            );\r\n        }\r\n    }, [products, addDistanceToProducts]);\r\n\r\n    useEffect(() => {\r\n        setFilteredProducts(products.filter(p => p.name.toLowerCase().includes(searchQuery.toLowerCase())));\r\n    }, [searchQuery, products]);\r\n\r\n    return { filteredProducts, loading, error };\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}